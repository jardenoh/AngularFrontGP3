<div class="build-page">
  <div class="pc-parts">

    <!-- Initial Typing -->
    <div class="button-box" *ngIf="showTyping" (click)="onBoxClick()" [ngClass]="{ 'pulsing': getSpinnerVisibility() }">
      <div class="typing-box">{{ typedText }}</div>
      <div class="typing-box response">{{ typedResponse }}</div>
    </div>

    <!-- Typing Description -->
    <div class="button-box" *ngIf="showDescriptionTyping" [ngClass]="{ 'pulsing': getSpinnerVisibility() }">
      <div class="typing-box">{{ typedDescription }}</div>
    </div>

    <!-- Spinner reserved space to prevent layout shift -->
    <div class="spinner-wrapper">
      <div *ngIf="getSpinnerVisibility()" class="spinner"></div>
    </div>

    <!-- Part Options (Recommended Parts Section) -->
    <div class="recommended-wrapper" *ngIf="showParts && results[currentPart]">
      <div class="recommended-block">
        <h2>Recommended {{ currentPart }}s</h2>
        <p class="subtext">Please choose a {{ currentPart }} and click to continue</p>
        <div class="part-row">
          <div class="part-card" *ngFor="let item of results[currentPart]" (click)="selectPart(currentPart, item)">
            <div *ngFor="let field of displayFields[currentPart]">
              <strong>{{ field }}:</strong> {{ item[field] }}
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Final Summary -->
    <div class="part-container" *ngIf="showSummary">
      <div class="part-section">
        <h2>Your Completed Build</h2>
        <div class="summary-row">
          <div class="part-card" *ngFor="let part of pcParts">
            <h3>{{ part.name }}</h3>
            <div *ngIf="selectedParts[part.name]">
              <div *ngFor="let field of displayFields[part.name]">
                <strong>{{ field }}:</strong> {{ selectedParts[part.name][field] }}
              </div>
            </div>
            <div *ngIf="!selectedParts[part.name]">
              <em>No selection</em>
            </div>
          </div>
        </div>

        <!-- Add All to Cart Button (Centered) -->
        <a [href]="amazonCartLink" target="_blank">
          <button style="margin-top: 20px; background-color: #FFA500; color: white; padding: 10px 20px; font-size: 1.2rem; border: none; border-radius: 5px; cursor: pointer;">
            Add All to Amazon Cart
          </button>
        </a>
      </div>
    </div>

  </div>
</div>
